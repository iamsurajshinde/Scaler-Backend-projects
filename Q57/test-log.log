[INFO] Scanning for projects...
[INFO] 
[INFO] ----------------------< org.example:Evaluations >-----------------------
[INFO] Building Evaluations 0.0.1-SNAPSHOT
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- resources:3.3.1:resources (default-resources) @ Evaluations ---
[INFO] Copying 1 resource from src/main/resources to target/classes
[INFO] Copying 0 resource from src/main/resources to target/classes
[INFO] 
[INFO] --- compiler:3.13.0:compile (default-compile) @ Evaluations ---
[INFO] Recompiling the module because of changed source code.
[INFO] Compiling 13 source files with javac [debug parameters release 17] to target/classes
[WARNING] /config/workspace/src/main/java/org/example/evaluations/evaluation/models/Category.java:[11,1] Generating equals/hashCode implementation but without a call to superclass, even though this class does not extend java.lang.Object. If this is intentional, add '@EqualsAndHashCode(callSuper=false)' to your type.
[WARNING] /config/workspace/src/main/java/org/example/evaluations/evaluation/models/SubCategory.java:[9,1] Generating equals/hashCode implementation but without a call to superclass, even though this class does not extend java.lang.Object. If this is intentional, add '@EqualsAndHashCode(callSuper=false)' to your type.
[WARNING] /config/workspace/src/main/java/org/example/evaluations/evaluation/models/Product.java:[13,1] Generating equals/hashCode implementation but without a call to superclass, even though this class does not extend java.lang.Object. If this is intentional, add '@EqualsAndHashCode(callSuper=false)' to your type.
[WARNING] /config/workspace/src/main/java/org/example/evaluations/evaluation/models/Image.java:[9,1] Generating equals/hashCode implementation but without a call to superclass, even though this class does not extend java.lang.Object. If this is intentional, add '@EqualsAndHashCode(callSuper=false)' to your type.
[INFO] 
[INFO] --- resources:3.3.1:testResources (default-testResources) @ Evaluations ---
[INFO] skip non existing resourceDirectory /config/workspace/src/test/resources
[INFO] 
[INFO] --- compiler:3.13.0:testCompile (default-testCompile) @ Evaluations ---
[INFO] Recompiling the module because of changed dependency.
[INFO] Compiling 1 source file with javac [debug parameters release 17] to target/test-classes
[INFO] 
[INFO] --- surefire:3.2.5:test (default-test) @ Evaluations ---
[INFO] Using auto detected provider org.apache.maven.surefire.junitplatform.JUnitPlatformProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.example.evaluations.services.CategoryServiceIntegrationTest
05:11:12.273 [main] INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils -- Could not detect default configuration classes for test class [org.example.evaluations.services.CategoryServiceIntegrationTest]: CategoryServiceIntegrationTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
05:11:12.372 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper -- Found @SpringBootConfiguration org.example.evaluations.EvaluationsApplication for test class org.example.evaluations.services.CategoryServiceIntegrationTest
05:11:12.560 [main] INFO org.springframework.boot.devtools.restart.RestartApplicationListener -- Restart disabled due to context in which it is running

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.3.2)

2025-07-27T05:11:12.883Z  INFO 20566 --- [Evaluations] [           main] o.e.e.s.CategoryServiceIntegrationTest   : Starting CategoryServiceIntegrationTest using Java 17.0.12 with PID 20566 (started by root in /config/workspace)
2025-07-27T05:11:12.886Z  INFO 20566 --- [Evaluations] [           main] o.e.e.s.CategoryServiceIntegrationTest   : No active profile set, falling back to 1 default profile: "default"
2025-07-27T05:11:13.828Z  INFO 20566 --- [Evaluations] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-07-27T05:11:13.885Z  INFO 20566 --- [Evaluations] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 50 ms. Found 4 JPA repository interfaces.
2025-07-27T05:11:14.428Z  INFO 20566 --- [Evaluations] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-07-27T05:11:14.619Z  INFO 20566 --- [Evaluations] [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:class11_ques2 user=SA
2025-07-27T05:11:14.621Z  INFO 20566 --- [Evaluations] [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-07-27T05:11:14.678Z  INFO 20566 --- [Evaluations] [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-07-27T05:11:14.728Z  INFO 20566 --- [Evaluations] [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.5.2.Final
2025-07-27T05:11:14.763Z  INFO 20566 --- [Evaluations] [           main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-07-27T05:11:15.129Z  INFO 20566 --- [Evaluations] [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-07-27T05:11:15.173Z  WARN 20566 --- [Evaluations] [           main] org.hibernate.orm.deprecation            : HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-07-27T05:11:16.313Z  INFO 20566 --- [Evaluations] [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
Hibernate: drop table if exists category cascade 
Hibernate: drop table if exists image cascade 
Hibernate: drop table if exists product cascade 
Hibernate: drop table if exists sub_category cascade 
Hibernate: create table category (state tinyint check (state between 0 and 1), id bigint generated by default as identity, title varchar(255), primary key (id))
Hibernate: create table image (state tinyint check (state between 0 and 1), id bigint generated by default as identity, product_id bigint, size_in_kb bigint, descriptive_name varchar(255), resolution varchar(255), primary key (id))
Hibernate: create table product (state tinyint check (state between 0 and 1), category_id bigint, id bigint generated by default as identity, name varchar(255), primary key (id))
Hibernate: create table sub_category (state tinyint check (state between 0 and 1), category_id bigint, id bigint generated by default as identity, description varchar(255), name varchar(255), primary key (id))
Hibernate: alter table if exists image add constraint FKgpextbyee3uk9u6o2381m7ft1 foreign key (product_id) references product
Hibernate: alter table if exists product add constraint FK1mtsbur82frn64de7balymq9s foreign key (category_id) references category
Hibernate: alter table if exists sub_category add constraint FKl65dyy5me2ypoyj8ou1hnt64e foreign key (category_id) references category
2025-07-27T05:11:16.390Z  INFO 20566 --- [Evaluations] [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-07-27T05:11:16.747Z  INFO 20566 --- [Evaluations] [           main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-07-27T05:11:17.308Z  WARN 20566 --- [Evaluations] [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-07-27T05:11:17.858Z  INFO 20566 --- [Evaluations] [           main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:class11_ques2'
2025-07-27T05:11:17.953Z  INFO 20566 --- [Evaluations] [           main] o.e.e.s.CategoryServiceIntegrationTest   : Started CategoryServiceIntegrationTest in 5.412 seconds (process running for 6.597)
2025-07-27T05:11:18.532Z  WARN 20566 --- [Evaluations] [           main] org.hibernate.orm.query                  : HHH90003004: firstResult/maxResults specified with collection fetch; applying in memory
Hibernate: select distinct c1_0.id,c1_0.state,sc1_0.category_id,sc1_0.id,sc1_0.description,sc1_0.name,sc1_0.state,c1_0.title from category c1_0 left join sub_category sc1_0 on c1_0.id=sc1_0.category_id
2025-07-27T05:11:18.633Z  WARN 20566 --- [Evaluations] [           main] org.hibernate.orm.query                  : HHH90003004: firstResult/maxResults specified with collection fetch; applying in memory
Hibernate: select distinct c1_0.id,c1_0.state,sc1_0.category_id,sc1_0.id,sc1_0.description,sc1_0.name,sc1_0.state,c1_0.title from category c1_0 left join sub_category sc1_0 on c1_0.id=sc1_0.category_id
[ERROR] Tests run: 2, Failures: 1, Errors: 1, Skipped: 0, Time elapsed: 6.672 s <<< FAILURE! -- in org.example.evaluations.services.CategoryServiceIntegrationTest
[ERROR] org.example.evaluations.services.CategoryServiceIntegrationTest.testGetNamesOfAllCategoriesAndTheirSubCategories_WithFetchModeSelectAndBatchSize3 -- Time elapsed: 0.661 s <<< FAILURE!
org.opentest4j.AssertionFailedError: Expected a select query with batch size 3 ==> expected: <true> but was: <false>
	at org.junit.jupiter.api.AssertionFailureBuilder.build(AssertionFailureBuilder.java:151)
	at org.junit.jupiter.api.AssertionFailureBuilder.buildAndThrow(AssertionFailureBuilder.java:132)
	at org.junit.jupiter.api.AssertTrue.failNotTrue(AssertTrue.java:63)
	at org.junit.jupiter.api.AssertTrue.assertTrue(AssertTrue.java:36)
	at org.junit.jupiter.api.Assertions.assertTrue(Assertions.java:214)
	at org.example.evaluations.services.CategoryServiceIntegrationTest.testGetNamesOfAllCategoriesAndTheirSubCategories_WithFetchModeSelectAndBatchSize3(CategoryServiceIntegrationTest.java:80)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)

[ERROR] org.example.evaluations.services.CategoryServiceIntegrationTest.testGetNamesOfAllCategoriesAndLinkedProductsAndTheirImages_WithFetchModeSubSelect -- Time elapsed: 0.018 s <<< ERROR!
org.springframework.dao.InvalidDataAccessApiUsageException: org.hibernate.loader.MultipleBagFetchException: cannot simultaneously fetch multiple bags: [org.example.evaluations.evaluation.models.Product.images, org.example.evaluations.evaluation.models.Category.products]
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:371)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:246)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:550)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:335)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy126.findAllWithProductsAndImages(Unknown Source)
	at org.example.evaluations.evaluation.services.CategoryService.getNamesOfAllCategoriesAndLinkedProductsAndTheirImages(CategoryService.java:22)
	at org.example.evaluations.services.CategoryServiceIntegrationTest.testGetNamesOfAllCategoriesAndLinkedProductsAndTheirImages_WithFetchModeSubSelect(CategoryServiceIntegrationTest.java:62)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
Caused by: java.lang.IllegalArgumentException: org.hibernate.loader.MultipleBagFetchException: cannot simultaneously fetch multiple bags: [org.example.evaluations.evaluation.models.Product.images, org.example.evaluations.evaluation.models.Category.products]
	at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:146)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:431)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:129)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:92)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:164)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:143)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:379)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 12 more
Caused by: org.hibernate.loader.MultipleBagFetchException: cannot simultaneously fetch multiple bags: [org.example.evaluations.evaluation.models.Product.images, org.example.evaluations.evaluation.models.Category.products]
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.createFetch(BaseSqmToSqlAstConverter.java:8281)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitFetches(BaseSqmToSqlAstConverter.java:8335)
	at org.hibernate.sql.results.graph.AbstractFetchParent.afterInitialize(AbstractFetchParent.java:32)
	at org.hibernate.sql.results.graph.entity.AbstractEntityResultGraphNode.afterInitialize(AbstractEntityResultGraphNode.java:72)
	at org.hibernate.persister.entity.AbstractEntityPersister.createDomainResult(AbstractEntityPersister.java:1361)
	at org.hibernate.query.sqm.sql.internal.AbstractSqmPathInterpretation.createDomainResult(AbstractSqmPathInterpretation.java:55)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.lambda$visitSelection$18(BaseSqmToSqlAstConverter.java:2292)
	at java.base/java.util.Collections$SingletonList.forEach(Collections.java:4966)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitSelection(BaseSqmToSqlAstConverter.java:2287)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitSelectClause(BaseSqmToSqlAstConverter.java:2205)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitQuerySpec(BaseSqmToSqlAstConverter.java:2076)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitQuerySpec(BaseSqmToSqlAstConverter.java:445)
	at org.hibernate.query.sqm.tree.select.SqmQuerySpec.accept(SqmQuerySpec.java:122)
	at org.hibernate.query.sqm.spi.BaseSemanticQueryWalker.visitQueryPart(BaseSemanticQueryWalker.java:244)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitQueryPart(BaseSqmToSqlAstConverter.java:1934)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitSelectStatement(BaseSqmToSqlAstConverter.java:1619)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.visitSelectStatement(BaseSqmToSqlAstConverter.java:445)
	at org.hibernate.query.sqm.tree.select.SqmSelectStatement.accept(SqmSelectStatement.java:234)
	at org.hibernate.query.sqm.sql.BaseSqmToSqlAstConverter.translate(BaseSqmToSqlAstConverter.java:784)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.buildCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:422)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:328)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:302)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:526)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:423)
	... 28 more

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   CategoryServiceIntegrationTest.testGetNamesOfAllCategoriesAndTheirSubCategories_WithFetchModeSelectAndBatchSize3:80 Expected a select query with batch size 3 ==> expected: <true> but was: <false>
[ERROR] Errors: 
[ERROR]   CategoryServiceIntegrationTest.testGetNamesOfAllCategoriesAndLinkedProductsAndTheirImages_WithFetchModeSubSelect:62 Â» InvalidDataAccessApiUsage org.hibernate.loader.MultipleBagFetchException: cannot simultaneously fetch multiple bags: [org.example.evaluations.evaluation.models.Product.images, org.example.evaluations.evaluation.models.Category.products]
[INFO] 
[ERROR] Tests run: 2, Failures: 1, Errors: 1, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  12.641 s
[INFO] Finished at: 2025-07-27T05:11:18Z
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.2.5:test (default-test) on project Evaluations: There are test failures.
[ERROR] 
[ERROR] Please refer to /config/workspace/target/surefire-reports for the individual test results.
[ERROR] Please refer to dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
